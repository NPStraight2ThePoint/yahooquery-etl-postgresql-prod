import psycopg2
from psycopg2 import sql
import os
from utils import DB_PARAMS

def create_schema_and_tables():
    schema = 'yahooquery'
    try:
        with psycopg2.connect(**DB_PARAMS) as conn:
            with conn.cursor() as cur:
                # Create schema
                cur.execute(sql.SQL("CREATE SCHEMA IF NOT EXISTS {}").format(sql.Identifier(schema)))
                print(f"âœ… Schema '{schema}' created or already exists")

                cur.execute(f"""
                    CREATE TABLE IF NOT EXISTS {schema}.pricing_history (
                        date DATE,
                        ticker TEXT,
                        open NUMERIC(18, 6),
                        high NUMERIC(18, 6),
                        low NUMERIC(18, 6),
                        close NUMERIC(18, 6),
                        adjclose NUMERIC(18, 6),
                        volume BIGINT,
                        dividends NUMERIC(18, 6),
                        splits NUMERIC(18, 6)
                    );
                """)

                cur.execute(f"""
                    CREATE TABLE IF NOT EXISTS {schema}.pricing_option_chain (
                        date DATE,
                        symbol TEXT,
                        expiration DATE,
                        optiontype TEXT,
                        contractsymbol TEXT,
                        strike NUMERIC(12, 4),
                        lastprice NUMERIC(12, 4),
                        bid NUMERIC(12, 4),
                        ask NUMERIC(12, 4),
                        volume INTEGER,
                        openinterest INTEGER,
                        impliedvolatility NUMERIC(8, 6),
                        inthemoney BOOLEAN
                    );
                """)

                cur.execute(f"""
                    CREATE TABLE IF NOT EXISTS {schema}.pricing_technical_insights (
                        date DATE,
                        symbol TEXT,
                        instrument_provider TEXT,
                        sector TEXT,

                        st_state_desc TEXT,
                        st_direction TEXT,
                        st_score INTEGER,
                        st_score_desc TEXT,
                        st_sector_direction TEXT,
                        st_sector_score INTEGER,
                        st_sector_score_desc TEXT,
                        st_index_direction TEXT,
                        st_index_score INTEGER,
                        st_index_score_desc TEXT,

                        it_state_desc TEXT,
                        it_direction TEXT,
                        it_score INTEGER,
                        it_score_desc TEXT,
                        it_sector_direction TEXT,
                        it_sector_score INTEGER,
                        it_sector_score_desc TEXT,
                        it_index_direction TEXT,
                        it_index_score INTEGER,
                        it_index_score_desc TEXT,

                        lt_state_desc TEXT,
                        lt_direction TEXT,
                        lt_score INTEGER,
                        lt_score_desc TEXT,
                        lt_sector_direction TEXT,
                        lt_sector_score INTEGER,
                        lt_sector_score_desc TEXT,
                        lt_index_direction TEXT,
                        lt_index_score INTEGER,
                        lt_index_score_desc TEXT,

                        keytechnicals_provider TEXT,
                        support NUMERIC,
                        resistance NUMERIC,
                        stoploss NUMERIC,

                        valuation_color TEXT,
                        valuation_desc TEXT,
                        valuation_discount TEXT,
                        valuation_relative TEXT,
                        valuation_provider TEXT,

                        company_sector_info TEXT,
                        comp_innovativeness NUMERIC,
                        comp_hiring NUMERIC,
                        comp_sustainability NUMERIC,
                        comp_insider_sentiments NUMERIC,
                        comp_earnings_reports NUMERIC,
                        comp_dividends NUMERIC,

                        sector_innovativeness NUMERIC,
                        sector_hiring NUMERIC,
                        sector_sustainability NUMERIC,
                        sector_insider_sentiments NUMERIC,
                        sector_earnings_reports NUMERIC,
                        sector_dividends NUMERIC,

                        target_price NUMERIC,
                        recommendation_provider TEXT,
                        recommendation_rating TEXT,

                        ms_bullish_summary TEXT,
                        ms_bearish_summary TEXT,
                        company_name TEXT,
                        ms_summary_date TEXT,
                        upsell_report_type TEXT,

                        research_report_id TEXT,
                        research_provider TEXT,
                        research_title TEXT,
                        research_date TEXT,
                        research_summary TEXT,
                        research_rating TEXT,

                        events JSONB,
                        sig_devs JSONB,
                        sec_reports JSONB
                    );
                """)

                cur.execute(f"""
                    CREATE TABLE IF NOT EXISTS {schema}.pricing_technical_reports (
                        date DATE,
                        symbol TEXT,
                        id TEXT,
                        headhtml TEXT,
                        provider TEXT,
                        reportdate TIMESTAMP,
                        reporttitle TEXT,
                        title TEXT,
                        targetprice NUMERIC,
                        investmentrating TEXT,
                        tickers_str TEXT
                    );
                """)

                cur.execute(f"""
                    CREATE TABLE IF NOT EXISTS {schema}.financial_statements_bs_a (
                        symbol TEXT,
                        asofdate DATE,
                        periodtype TEXT,
                        currencycode TEXT,
                        accountspayable NUMERIC(20, 4),
                        accountsreceivable NUMERIC(20, 4),
                        accumulateddepreciation NUMERIC(20, 4),
                        availableforsalesecurities NUMERIC(20, 4),
                        capitalleaseobligations NUMERIC(20, 4),
                        capitalstock NUMERIC(20, 4),
                        cashandcashequivalents NUMERIC(20, 4),
                        cashcashequivalentsandshortterminvestments NUMERIC(20, 4),
                        cashequivalents NUMERIC(20, 4),
                        cashfinancial NUMERIC(20, 4),
                        commercialpaper NUMERIC(20, 4),
                        commonstock NUMERIC(20, 4),
                        commonstockequity NUMERIC(20, 4),
                        currentassets NUMERIC(20, 4),
                        currentcapitalleaseobligation NUMERIC(20, 4),
                        currentdebt NUMERIC(20, 4),
                        currentdebtandcapitalleaseobligation NUMERIC(20, 4),
                        currentdeferredliabilities NUMERIC(20, 4),
                        currentdeferredrevenue NUMERIC(20, 4),
                        currentliabilities NUMERIC(20, 4),
                        gainslossesnotaffectingretainedearnings NUMERIC(20, 4),
                        grossppe NUMERIC(20, 4),
                        incometaxpayable NUMERIC(20, 4),
                        inventory NUMERIC(20, 4),
                        investedcapital NUMERIC(20, 4),
                        investmentinfinancialassets NUMERIC(20, 4),
                        investmentsandadvances NUMERIC(20, 4),
                        landandimprovements NUMERIC(20, 4),
                        leases NUMERIC(20, 4),
                        longtermcapitalleaseobligation NUMERIC(20, 4),
                        longtermdebt NUMERIC(20, 4),
                        longtermdebtandcapitalleaseobligation NUMERIC(20, 4),
                        machineryfurnitureequipment NUMERIC(20, 4),
                        netdebt NUMERIC(20, 4),
                        netppe NUMERIC(20, 4),
                        nettangibleassets NUMERIC(20, 4),
                        noncurrentdeferredassets NUMERIC(20, 4),
                        noncurrentdeferredtaxesassets NUMERIC(20, 4),
                        ordinarysharesnumber NUMERIC(20, 4),
                        othercurrentassets NUMERIC(20, 4),
                        othercurrentborrowings NUMERIC(20, 4),
                        othercurrentliabilities NUMERIC(20, 4),
                        otherequityadjustments NUMERIC(20, 4),
                        otherinvestments NUMERIC(20, 4),
                        othernoncurrentassets NUMERIC(20, 4),
                        othernoncurrentliabilities NUMERIC(20, 4),
                        otherproperties NUMERIC(20, 4),
                        otherreceivables NUMERIC(20, 4),
                        othershortterminvestments NUMERIC(20, 4),
                        payables NUMERIC(20, 4),
                        payablesandaccruedexpenses NUMERIC(20, 4),
                        properties NUMERIC(20, 4),
                        receivables NUMERIC(20, 4),
                        retainedearnings NUMERIC(20, 4),
                        shareissued NUMERIC(20, 4),
                        stockholdersequity NUMERIC(20, 4),
                        tangiblebookvalue NUMERIC(20, 4),
                        totalassets NUMERIC(20, 4),
                        totalcapitalization NUMERIC(20, 4),
                        totaldebt NUMERIC(20, 4),
                        totalequitygrossminorityinterest NUMERIC(20, 4),
                        totalliabilitiesnetminorityinterest NUMERIC(20, 4),
                        totalnoncurrentassets NUMERIC(20, 4),
                        totalnoncurrentliabilitiesnetminorityinterest NUMERIC(20, 4),
                        totaltaxpayable NUMERIC(20, 4),
                        tradeandotherpayablesnoncurrent NUMERIC(20, 4),
                        treasurysharesnumber NUMERIC(20, 4),
                        workingcapital NUMERIC(20, 4),
                        additionalpaidincapital NUMERIC(20, 4),
                        buildingsandimprovements NUMERIC(20, 4),
                        constructioninprogress NUMERIC(20, 4),
                        currentaccruedexpenses NUMERIC(20, 4),
                        dividendspayable NUMERIC(20, 4),
                        employeebenefits NUMERIC(20, 4),
                        finishedgoods NUMERIC(20, 4),
                        goodwill NUMERIC(20, 4),
                        goodwillandotherintangibleassets NUMERIC(20, 4),
                        minorityinterest NUMERIC(20, 4),
                        noncurrentdeferredliabilities NUMERIC(20, 4),
                        noncurrentdeferredtaxesliabilities NUMERIC(20, 4),
                        noncurrentpensionandotherpostretirementbenefitplans NUMERIC(20, 4),
                        otherintangibleassets NUMERIC(20, 4),
                        prepaidassets NUMERIC(20, 4),
                        rawmaterials NUMERIC(20, 4),
                        treasurystock NUMERIC(20, 4),
                        workinprocess NUMERIC(20, 4),
                        allowancefordoubtfulaccountsreceivable NUMERIC(20, 4),
                        currentdeferredtaxesliabilities NUMERIC(20, 4),
                        currentprovisions NUMERIC(20, 4),
                        grossaccountsreceivable NUMERIC(20, 4),
                        otherpayable NUMERIC(20, 4),
                        pensionandotherpostretirementbenefitplanscurrent NUMERIC(20, 4),
                        preferredsecuritiesoutsidestockequity NUMERIC(20, 4),
                        restrictedcash NUMERIC(20, 4),
                        preferredstock NUMERIC(20, 4),
                        investmentsinotherventuresunderequitymethod NUMERIC(20, 4),
                        lineofcredit NUMERIC(20, 4),
                        longtermequityinvestment NUMERIC(20, 4),
                        preferredsharesnumber NUMERIC(20, 4),
                        preferredstockequity NUMERIC(20, 4),
                        noncurrentaccountsreceivable NUMERIC(20, 4),
                        noncurrentdeferredrevenue NUMERIC(20, 4),
                        otherequityinterest NUMERIC(20, 4),
                        interestpayable NUMERIC(20, 4),
                        currentnotespayable NUMERIC(20, 4),
                        currentdeferredassets NUMERIC(20, 4),
                        hedgingassetscurrent NUMERIC(20, 4),
                        investmentsinassociatesatcost NUMERIC(20, 4),
                        otherinventories NUMERIC(20, 4),
                        taxesreceivable NUMERIC(20, 4),
                        definedpensionbenefit NUMERIC(20, 4),
                        longtermprovisions NUMERIC(20, 4),
                        assetsheldforsalecurrent NUMERIC(20, 4),
                        derivativeproductliabilities NUMERIC(20, 4),
                        financialassets NUMERIC(20, 4),
                        heldtomaturitysecurities NUMERIC(20, 4),
                        receivablesadjustmentsallowances NUMERIC(20, 4),
                        liabilitiesheldforsalenoncurrent NUMERIC(20, 4),
                        noncurrentnotereceivables NUMERIC(20, 4),
                        foreigncurrencytranslationadjustments NUMERIC(20, 4),
                        loansreceivable NUMERIC(20, 4),
                        minimumpensionliabilities NUMERIC(20, 4),
                        unrealizedgainloss NUMERIC(20, 4),
                        duetorelatedpartiescurrent NUMERIC(20, 4),
                        investmentsinjointventuresatcost NUMERIC(20, 4),
                        notesreceivable NUMERIC(20, 4),
                        inventoriesadjustmentsallowances NUMERIC(20, 4),
                        duefromrelatedpartiescurrent NUMERIC(20, 4),
                        noncurrentprepaidassets NUMERIC(20, 4),
                        noncurrentaccruedexpenses NUMERIC(20, 4),
                        investmentproperties NUMERIC(20, 4),
                        tradingsecurities NUMERIC(20, 4),
                        financialassetsdesignatedasfairvaluethroughprofitorlosstotal NUMERIC(20, 4),
                        investmentsinsubsidiariesatcost NUMERIC(20, 4),
                        duetorelatedpartiesnoncurrent NUMERIC(20, 4),
                        currentdeferredtaxesassets NUMERIC(20, 4),
                        accruedinterestreceivable NUMERIC(20, 4),
                        duefromrelatedpartiesnoncurrent NUMERIC(20, 4),
                        restrictedcommonstock NUMERIC(20, 4),
                        limitedpartnershipcapital NUMERIC(20, 4),
                        totalpartnershipcapital NUMERIC(20, 4)
                    );
                """)

                cur.execute(f"""
                    CREATE TABLE IF NOT EXISTS {schema}.financial_statements_bs_q (
                        symbol TEXT,
                        asofdate DATE,
                        periodtype TEXT,
                        currencycode TEXT,
                        accountspayable NUMERIC(20, 4),
                        accountsreceivable NUMERIC(20, 4),
                        accumulateddepreciation NUMERIC(20, 4),
                        availableforsalesecurities NUMERIC(20, 4),
                        capitalstock NUMERIC(20, 4),
                        cashandcashequivalents NUMERIC(20, 4),
                        cashcashequivalentsandshortterminvestments NUMERIC(20, 4),
                        cashequivalents NUMERIC(20, 4),
                        cashfinancial NUMERIC(20, 4),
                        commercialpaper NUMERIC(20, 4),
                        commonstock NUMERIC(20, 4),
                        commonstockequity NUMERIC(20, 4),
                        currentassets NUMERIC(20, 4),
                        currentdebt NUMERIC(20, 4),
                        currentdebtandcapitalleaseobligation NUMERIC(20, 4),
                        currentdeferredliabilities NUMERIC(20, 4),
                        currentdeferredrevenue NUMERIC(20, 4),
                        currentliabilities NUMERIC(20, 4),
                        finishedgoods NUMERIC(20, 4),
                        gainslossesnotaffectingretainedearnings NUMERIC(20, 4),
                        grossppe NUMERIC(20, 4),
                        incometaxpayable NUMERIC(20, 4),
                        inventory NUMERIC(20, 4),
                        investedcapital NUMERIC(20, 4),
                        investmentinfinancialassets NUMERIC(20, 4),
                        investmentsandadvances NUMERIC(20, 4),
                        landandimprovements NUMERIC(20, 4),
                        leases NUMERIC(20, 4),
                        longtermdebt NUMERIC(20, 4),
                        longtermdebtandcapitalleaseobligation NUMERIC(20, 4),
                        machineryfurnitureequipment NUMERIC(20, 4),
                        netdebt NUMERIC(20, 4),
                        netppe NUMERIC(20, 4),
                        nettangibleassets NUMERIC(20, 4),
                        noncurrentdeferredassets NUMERIC(20, 4),
                        noncurrentdeferredtaxesassets NUMERIC(20, 4),
                        ordinarysharesnumber NUMERIC(20, 4),
                        othercurrentassets NUMERIC(20, 4),
                        othercurrentborrowings NUMERIC(20, 4),
                        othercurrentliabilities NUMERIC(20, 4),
                        otherequityadjustments NUMERIC(20, 4),
                        othernoncurrentassets NUMERIC(20, 4),
                        othernoncurrentliabilities NUMERIC(20, 4),
                        otherreceivables NUMERIC(20, 4),
                        othershortterminvestments NUMERIC(20, 4),
                        payables NUMERIC(20, 4),
                        payablesandaccruedexpenses NUMERIC(20, 4),
                        properties NUMERIC(20, 4),
                        rawmaterials NUMERIC(20, 4),
                        receivables NUMERIC(20, 4),
                        retainedearnings NUMERIC(20, 4),
                        shareissued NUMERIC(20, 4),
                        stockholdersequity NUMERIC(20, 4),
                        tangiblebookvalue NUMERIC(20, 4),
                        totalassets NUMERIC(20, 4),
                        totalcapitalization NUMERIC(20, 4),
                        totaldebt NUMERIC(20, 4),
                        totalequitygrossminorityinterest NUMERIC(20, 4),
                        totalliabilitiesnetminorityinterest NUMERIC(20, 4),
                        totalnoncurrentassets NUMERIC(20, 4),
                        totalnoncurrentliabilitiesnetminorityinterest NUMERIC(20, 4),
                        totaltaxpayable NUMERIC(20, 4),
                        tradeandotherpayablesnoncurrent NUMERIC(20, 4),
                        treasurysharesnumber NUMERIC(20, 4),
                        workingcapital NUMERIC(20, 4),
                        additionalpaidincapital NUMERIC(20, 4),
                        buildingsandimprovements NUMERIC(20, 4),
                        constructioninprogress NUMERIC(20, 4),
                        currentaccruedexpenses NUMERIC(20, 4),
                        dividendspayable NUMERIC(20, 4),
                        employeebenefits NUMERIC(20, 4),
                        goodwill NUMERIC(20, 4),
                        goodwillandotherintangibleassets NUMERIC(20, 4),
                        minorityinterest NUMERIC(20, 4),
                        noncurrentdeferredliabilities NUMERIC(20, 4),
                        noncurrentdeferredtaxesliabilities NUMERIC(20, 4),
                        noncurrentpensionandotherpostretirementbenefitplans NUMERIC(20, 4),
                        otherintangibleassets NUMERIC(20, 4),
                        treasurystock NUMERIC(20, 4),
                        workinprocess NUMERIC(20, 4),
                        allowancefordoubtfulaccountsreceivable NUMERIC(20, 4),
                        capitalleaseobligations NUMERIC(20, 4),
                        currentcapitalleaseobligation NUMERIC(20, 4),
                        grossaccountsreceivable NUMERIC(20, 4),
                        longtermcapitalleaseobligation NUMERIC(20, 4),
                        otherpayable NUMERIC(20, 4),
                        otherproperties NUMERIC(20, 4),
                        pensionandotherpostretirementbenefitplanscurrent NUMERIC(20, 4),
                        otherinvestments NUMERIC(20, 4),
                        preferredstock NUMERIC(20, 4),
                        investmentsinotherventuresunderequitymethod NUMERIC(20, 4),
                        longtermequityinvestment NUMERIC(20, 4),
                        preferredsharesnumber NUMERIC(20, 4),
                        preferredstockequity NUMERIC(20, 4),
                        prepaidassets NUMERIC(20, 4),
                        noncurrentaccountsreceivable NUMERIC(20, 4),
                        noncurrentdeferredrevenue NUMERIC(20, 4),
                        otherequityinterest NUMERIC(20, 4),
                        currentprovisions NUMERIC(20, 4),
                        interestpayable NUMERIC(20, 4),
                        hedgingassetscurrent NUMERIC(20, 4),
                        otherinventories NUMERIC(20, 4),
                        restrictedcash NUMERIC(20, 4),
                        taxesreceivable NUMERIC(20, 4),
                        heldtomaturitysecurities NUMERIC(20, 4),
                        definedpensionbenefit NUMERIC(20, 4),
                        longtermprovisions NUMERIC(20, 4),
                        assetsheldforsalecurrent NUMERIC(20, 4),
                        currentnotespayable NUMERIC(20, 4),
                        derivativeproductliabilities NUMERIC(20, 4),
                        financialassets NUMERIC(20, 4),
                        lineofcredit NUMERIC(20, 4),
                        preferredsecuritiesoutsidestockequity NUMERIC(20, 4),
                        receivablesadjustmentsallowances NUMERIC(20, 4),
                        investmentsinassociatesatcost NUMERIC(20, 4),
                        liabilitiesheldforsalenoncurrent NUMERIC(20, 4),
                        foreigncurrencytranslationadjustments NUMERIC(20, 4),
                        loansreceivable NUMERIC(20, 4),
                        minimumpensionliabilities NUMERIC(20, 4),
                        unrealizedgainloss NUMERIC(20, 4),
                        currentdeferredassets NUMERIC(20, 4),
                        duetorelatedpartiescurrent NUMERIC(20, 4),
                        investmentsinjointventuresatcost NUMERIC(20, 4),
                        duefromrelatedpartiescurrent NUMERIC(20, 4),
                        inventoriesadjustmentsallowances NUMERIC(20, 4),
                        noncurrentprepaidassets NUMERIC(20, 4),
                        noncurrentaccruedexpenses NUMERIC(20, 4),
                        notesreceivable NUMERIC(20, 4),
                        investmentproperties NUMERIC(20, 4),
                        noncurrentnotereceivables NUMERIC(20, 4),
                        tradingsecurities NUMERIC(20, 4),
                        financialassetsdesignatedasfairvaluethroughprofitorlosstotal NUMERIC(20, 4),
                        investmentsinsubsidiariesatcost NUMERIC(20, 4),
                        currentdeferredtaxesassets NUMERIC(20, 4),
                        accruedinterestreceivable NUMERIC(20, 4),
                        duefromrelatedpartiesnoncurrent NUMERIC(20, 4),
                        duetorelatedpartiesnoncurrent NUMERIC(20, 4)
                    );
                """)

                cur.execute(f"""
                    CREATE TABLE IF NOT EXISTS {schema}.financial_statements_cf_a (
                        symbol TEXT,
                        asofdate DATE,
                        periodtype TEXT,
                        currencycode TEXT,
                        beginningcashposition NUMERIC,
                        capitalexpenditure NUMERIC,
                        cashdividendspaid NUMERIC,
                        cashflowfromcontinuingfinancingactivities NUMERIC,
                        cashflowfromcontinuinginvestingactivities NUMERIC,
                        cashflowfromcontinuingoperatingactivities NUMERIC,
                        changeinaccountpayable NUMERIC,
                        changeincashsupplementalasreported NUMERIC,
                        changeininventory NUMERIC,
                        changeinothercurrentassets NUMERIC,
                        changeinothercurrentliabilities NUMERIC,
                        changeinotherworkingcapital NUMERIC,
                        changeinpayable NUMERIC,
                        changeinpayablesandaccruedexpense NUMERIC,
                        changeinreceivables NUMERIC,
                        changeinworkingcapital NUMERIC,
                        changesinaccountreceivables NUMERIC,
                        changesincash NUMERIC,
                        commonstockdividendpaid NUMERIC,
                        commonstockissuance NUMERIC,
                        commonstockpayments NUMERIC,
                        deferredincometax NUMERIC,
                        deferredtax NUMERIC,
                        depreciationamortizationdepletion NUMERIC,
                        depreciationandamortization NUMERIC,
                        endcashposition NUMERIC,
                        financingcashflow NUMERIC,
                        freecashflow NUMERIC,
                        incometaxpaidsupplementaldata NUMERIC,
                        interestpaidsupplementaldata NUMERIC,
                        investingcashflow NUMERIC,
                        issuanceofcapitalstock NUMERIC,
                        issuanceofdebt NUMERIC,
                        longtermdebtissuance NUMERIC,
                        longtermdebtpayments NUMERIC,
                        netbusinesspurchaseandsale NUMERIC,
                        netcommonstockissuance NUMERIC,
                        netincome NUMERIC,
                        netincomefromcontinuingoperations NUMERIC,
                        netinvestmentpurchaseandsale NUMERIC,
                        netissuancepaymentsofdebt NUMERIC,
                        netlongtermdebtissuance NUMERIC,
                        netotherfinancingcharges NUMERIC,
                        netotherinvestingchanges NUMERIC,
                        netppepurchaseandsale NUMERIC,
                        netshorttermdebtissuance NUMERIC,
                        operatingcashflow NUMERIC,
                        othernoncashitems NUMERIC,
                        purchaseofbusiness NUMERIC,
                        purchaseofinvestment NUMERIC,
                        purchaseofppe NUMERIC,
                        repaymentofdebt NUMERIC,
                        repurchaseofcapitalstock NUMERIC,
                        saleofinvestment NUMERIC,
                        stockbasedcompensation NUMERIC,
                        amortizationcashflow NUMERIC,
                        amortizationofintangibles NUMERIC,
                        assetimpairmentcharge NUMERIC,
                        changeinprepaidassets NUMERIC,
                        depreciation NUMERIC,
                        effectofexchangeratechanges NUMERIC,
                        gainlossonsaleofbusiness NUMERIC,
                        operatinggainslosses NUMERIC,
                        proceedsfromstockoptionexercised NUMERIC,
                        provisionandwriteoffofassets NUMERIC,
                        shorttermdebtissuance NUMERIC,
                        shorttermdebtpayments NUMERIC,
                        amortizationofsecurities NUMERIC,
                        changeinaccruedexpense NUMERIC,
                        gainlossoninvestmentsecurities NUMERIC,
                        netforeigncurrencyexchangegainloss NUMERIC,
                        netpreferredstockissuance NUMERIC,
                        preferredstockissuance NUMERIC,
                        changeinincometaxpayable NUMERIC,
                        changeintaxpayable NUMERIC,
                        saleofbusiness NUMERIC,
                        earningslossesfromequityinvestments NUMERIC,
                        preferredstockdividendpaid NUMERIC,
                        preferredstockpayments NUMERIC,
                        gainlossonsaleofppe NUMERIC,
                        unrealizedgainlossoninvestmentsecurities NUMERIC,
                        saleofppe NUMERIC,
                        capitalexpenditurereported NUMERIC,
                        netintangiblespurchaseandsale NUMERIC,
                        pensionandemployeebenefitexpense NUMERIC,
                        purchaseofintangibles NUMERIC,
                        othercashadjustmentinsidechangeincash NUMERIC,
                        cashfromdiscontinuedfinancingactivities NUMERIC,
                        cashfromdiscontinuedinvestingactivities NUMERIC,
                        cashfromdiscontinuedoperatingactivities NUMERIC,
                        othercashadjustmentoutsidechangeincash NUMERIC,
                        dividendreceivedcfo NUMERIC,
                        changeininterestpayable NUMERIC,
                        dividendsreceivedcfi NUMERIC,
                        saleofintangibles NUMERIC,
                        netinvestmentpropertiespurchaseandsale NUMERIC,
                        purchaseofinvestmentproperties NUMERIC,
                        saleofinvestmentproperties NUMERIC,
                        excesstaxbenefitfromstockbasedcompensation NUMERIC,
                        interestreceivedcfi NUMERIC,
                        interestpaidcff NUMERIC,
                        depletion NUMERIC,
                        cashflowfromdiscontinuedoperation NUMERIC,
                        cashflowsfromusedinoperatingactivitiesdirect NUMERIC,
                        classesofcashpayments NUMERIC,
                        classesofcashreceiptsfromoperatingactivities NUMERIC,
                        othercashpaymentsfromoperatingactivities NUMERIC,
                        othercashreceiptsfromoperatingactivities NUMERIC,
                        paymentsonbehalfofemployees NUMERIC,
                        taxesrefundpaid NUMERIC,
                        dividendpaidcfo NUMERIC,
                        interestpaidcfo NUMERIC
                    );
                """)

                cur.execute(f"""
                    CREATE TABLE IF NOT EXISTS {schema}.financial_statements_cf_q (
                        symbol TEXT,
                        asofdate DATE,
                        periodtype TEXT,
                        currencycode TEXT,
                        beginningcashposition NUMERIC,
                        capitalexpenditure NUMERIC,
                        cashdividendspaid NUMERIC,
                        cashflowfromcontinuingfinancingactivities NUMERIC,
                        cashflowfromcontinuinginvestingactivities NUMERIC,
                        cashflowfromcontinuingoperatingactivities NUMERIC,
                        changeinaccountpayable NUMERIC,
                        changeincashsupplementalasreported NUMERIC,
                        changeininventory NUMERIC,
                        changeinothercurrentassets NUMERIC,
                        changeinothercurrentliabilities NUMERIC,
                        changeinpayable NUMERIC,
                        changeinpayablesandaccruedexpense NUMERIC,
                        changeinreceivables NUMERIC,
                        changeinworkingcapital NUMERIC,
                        changesinaccountreceivables NUMERIC,
                        changesincash NUMERIC,
                        commonstockdividendpaid NUMERIC,
                        commonstockpayments NUMERIC,
                        depreciationamortizationdepletion NUMERIC,
                        depreciationandamortization NUMERIC,
                        endcashposition NUMERIC,
                        financingcashflow NUMERIC,
                        freecashflow NUMERIC,
                        incometaxpaidsupplementaldata NUMERIC,
                        investingcashflow NUMERIC,
                        issuanceofdebt NUMERIC,
                        longtermdebtissuance NUMERIC,
                        longtermdebtpayments NUMERIC,
                        netcommonstockissuance NUMERIC,
                        netincome NUMERIC,
                        netincomefromcontinuingoperations NUMERIC,
                        netinvestmentpurchaseandsale NUMERIC,
                        netissuancepaymentsofdebt NUMERIC,
                        netlongtermdebtissuance NUMERIC,
                        netotherfinancingcharges NUMERIC,
                        netotherinvestingchanges NUMERIC,
                        netppepurchaseandsale NUMERIC,
                        netshorttermdebtissuance NUMERIC,
                        operatingcashflow NUMERIC,
                        othernoncashitems NUMERIC,
                        purchaseofinvestment NUMERIC,
                        purchaseofppe NUMERIC,
                        repaymentofdebt NUMERIC,
                        repurchaseofcapitalstock NUMERIC,
                        saleofinvestment NUMERIC,
                        shorttermdebtpayments NUMERIC,
                        stockbasedcompensation NUMERIC,
                        amortizationcashflow NUMERIC,
                        amortizationofintangibles NUMERIC,
                        assetimpairmentcharge NUMERIC,
                        changeinotherworkingcapital NUMERIC,
                        changeinprepaidassets NUMERIC,
                        deferredincometax NUMERIC,
                        deferredtax NUMERIC,
                        depreciation NUMERIC,
                        effectofexchangeratechanges NUMERIC,
                        gainlossonsaleofbusiness NUMERIC,
                        interestpaidsupplementaldata NUMERIC,
                        netbusinesspurchaseandsale NUMERIC,
                        proceedsfromstockoptionexercised NUMERIC,
                        provisionandwriteoffofassets NUMERIC,
                        purchaseofbusiness NUMERIC,
                        shorttermdebtissuance NUMERIC,
                        amortizationofsecurities NUMERIC,
                        changeinaccruedexpense NUMERIC,
                        netpreferredstockissuance NUMERIC,
                        preferredstockissuance NUMERIC,
                        saleofbusiness NUMERIC,
                        earningslossesfromequityinvestments NUMERIC,
                        gainlossoninvestmentsecurities NUMERIC,
                        issuanceofcapitalstock NUMERIC,
                        operatinggainslosses NUMERIC,
                        preferredstockdividendpaid NUMERIC,
                        changeinincometaxpayable NUMERIC,
                        changeintaxpayable NUMERIC,
                        commonstockissuance NUMERIC,
                        gainlossonsaleofppe NUMERIC,
                        unrealizedgainlossoninvestmentsecurities NUMERIC,
                        capitalexpenditurereported NUMERIC,
                        netintangiblespurchaseandsale NUMERIC,
                        pensionandemployeebenefitexpense NUMERIC,
                        purchaseofintangibles NUMERIC,
                        saleofppe NUMERIC,
                        netforeigncurrencyexchangegainloss NUMERIC,
                        othercashadjustmentinsidechangeincash NUMERIC,
                        cashfromdiscontinuedfinancingactivities NUMERIC,
                        cashfromdiscontinuedinvestingactivities NUMERIC,
                        cashfromdiscontinuedoperatingactivities NUMERIC,
                        othercashadjustmentoutsidechangeincash NUMERIC,
                        preferredstockpayments NUMERIC,
                        dividendreceivedcfo NUMERIC,
                        netinvestmentpropertiespurchaseandsale NUMERIC,
                        purchaseofinvestmentproperties NUMERIC,
                        saleofinvestmentproperties NUMERIC,
                        dividendsreceivedcfi NUMERIC,
                        saleofintangibles NUMERIC,
                        changeininterestpayable NUMERIC,
                        excesstaxbenefitfromstockbasedcompensation NUMERIC,
                        interestpaidcff NUMERIC,
                        depletion NUMERIC,
                        dividendpaidcfo NUMERIC,
                        cashflowfromdiscontinuedoperation NUMERIC,
                        cashflowsfromusedinoperatingactivitiesdirect NUMERIC,
                        classesofcashpayments NUMERIC,
                        classesofcashreceiptsfromoperatingactivities NUMERIC,
                        othercashpaymentsfromoperatingactivities NUMERIC,
                        othercashreceiptsfromoperatingactivities NUMERIC,
                        paymentsonbehalfofemployees NUMERIC,
                        taxesrefundpaid NUMERIC,
                        interestreceivedcfi NUMERIC,
                        interestpaidcfo NUMERIC
                    );
                """)

                cur.execute(f"""
                    CREATE TABLE IF NOT EXISTS {schema}.financial_statements_is_a (
                        symbol TEXT,
                        asofdate DATE,
                        periodtype TEXT,
                        currencycode TEXT,
                        basicaverageshares NUMERIC,
                        basiceps NUMERIC,
                        costofrevenue NUMERIC,
                        dilutedaverageshares NUMERIC,
                        dilutedeps NUMERIC,
                        dilutedniavailtocomstockholders NUMERIC,
                        ebit NUMERIC,
                        ebitda NUMERIC,
                        grossprofit NUMERIC,
                        interestexpense NUMERIC,
                        interestexpensenonoperating NUMERIC,
                        interestincome NUMERIC,
                        interestincomenonoperating NUMERIC,
                        netincome NUMERIC,
                        netincomecommonstockholders NUMERIC,
                        netincomecontinuousoperations NUMERIC,
                        netincomefromcontinuinganddiscontinuedoperation NUMERIC,
                        netincomefromcontinuingoperationnetminorityinterest NUMERIC,
                        netincomeincludingnoncontrollinginterests NUMERIC,
                        netinterestincome NUMERIC,
                        netnonoperatinginterestincomeexpense NUMERIC,
                        normalizedebitda NUMERIC,
                        normalizedincome NUMERIC,
                        operatingexpense NUMERIC,
                        operatingincome NUMERIC,
                        operatingrevenue NUMERIC,
                        otherincomeexpense NUMERIC,
                        othernonoperatingincomeexpenses NUMERIC,
                        pretaxincome NUMERIC,
                        reconciledcostofrevenue NUMERIC,
                        reconcileddepreciation NUMERIC,
                        researchanddevelopment NUMERIC,
                        sellinggeneralandadministration NUMERIC,
                        taxeffectofunusualitems NUMERIC,
                        taxprovision NUMERIC,
                        taxrateforcalcs NUMERIC,
                        totalexpenses NUMERIC,
                        totaloperatingincomeasreported NUMERIC,
                        totalrevenue NUMERIC,
                        gainonsaleofsecurity NUMERIC,
                        minorityinterests NUMERIC,
                        otheroperatingexpenses NUMERIC,
                        otherspecialcharges NUMERIC,
                        otherunderpreferredstockdividend NUMERIC,
                        specialincomecharges NUMERIC,
                        totalunusualitems NUMERIC,
                        totalunusualitemsexcludinggoodwill NUMERIC,
                        generalandadministrativeexpense NUMERIC,
                        otherganda NUMERIC,
                        restructuringandmergernacquisition NUMERIC,
                        sellingandmarketingexpense NUMERIC,
                        amortization NUMERIC,
                        amortizationofintangiblesincomestatement NUMERIC,
                        depreciationamortizationdepletionincomestatement NUMERIC,
                        depreciationandamortizationinincomestatement NUMERIC,
                        netincomediscontinuousoperations NUMERIC,
                        earningsfromequityinterestnetoftax NUMERIC,
                        preferredstockdividends NUMERIC,
                        averagedilutionearnings NUMERIC,
                        gainonsaleofbusiness NUMERIC,
                        earningsfromequityinterest NUMERIC,
                        gainonsaleofppe NUMERIC,
                        impairmentofcapitalassets NUMERIC,
                        writeoff NUMERIC,
                        salariesandwages NUMERIC,
                        totalotherfinancecost NUMERIC,
                        othertaxes NUMERIC,
                        depreciationincomestatement NUMERIC,
                        provisionfordoubtfulaccounts NUMERIC,
                        rentandlandingfees NUMERIC,
                        rentexpensesupplemental NUMERIC,
                        insuranceandclaims NUMERIC,
                        excisetaxes NUMERIC,
                        depletionincomestatement NUMERIC,
                        netincomeextraordinary NUMERIC,
                        netincomefromtaxlosscarryforward NUMERIC,
                        securitiesamortization NUMERIC
                    );
                """)

                cur.execute(f"""
                    CREATE TABLE IF NOT EXISTS {schema}.financial_statements_is_q (
                        symbol TEXT,
                        asofdate DATE,
                        periodtype TEXT,
                        currencycode TEXT,
                        basicaverageshares NUMERIC,
                        basiceps NUMERIC,
                        costofrevenue NUMERIC,
                        dilutedaverageshares NUMERIC,
                        dilutedeps NUMERIC,
                        dilutedniavailtocomstockholders NUMERIC,
                        ebit NUMERIC,
                        ebitda NUMERIC,
                        grossprofit NUMERIC,
                        netincome NUMERIC,
                        netincomecommonstockholders NUMERIC,
                        netincomecontinuousoperations NUMERIC,
                        netincomefromcontinuinganddiscontinuedoperation NUMERIC,
                        netincomefromcontinuingoperationnetminorityinterest NUMERIC,
                        netincomeincludingnoncontrollinginterests NUMERIC,
                        normalizedebitda NUMERIC,
                        normalizedincome NUMERIC,
                        operatingexpense NUMERIC,
                        operatingincome NUMERIC,
                        operatingrevenue NUMERIC,
                        otherincomeexpense NUMERIC,
                        othernonoperatingincomeexpenses NUMERIC,
                        pretaxincome NUMERIC,
                        reconciledcostofrevenue NUMERIC,
                        reconcileddepreciation NUMERIC,
                        researchanddevelopment NUMERIC,
                        sellinggeneralandadministration NUMERIC,
                        taxeffectofunusualitems NUMERIC,
                        taxprovision NUMERIC,
                        taxrateforcalcs NUMERIC,
                        totalexpenses NUMERIC,
                        totaloperatingincomeasreported NUMERIC,
                        totalrevenue NUMERIC,
                        gainonsaleofsecurity NUMERIC,
                        interestexpense NUMERIC,
                        interestexpensenonoperating NUMERIC,
                        interestincome NUMERIC,
                        interestincomenonoperating NUMERIC,
                        minorityinterests NUMERIC,
                        netinterestincome NUMERIC,
                        netnonoperatinginterestincomeexpense NUMERIC,
                        otheroperatingexpenses NUMERIC,
                        otherspecialcharges NUMERIC,
                        otherunderpreferredstockdividend NUMERIC,
                        restructuringandmergernacquisition NUMERIC,
                        specialincomecharges NUMERIC,
                        totalunusualitems NUMERIC,
                        totalunusualitemsexcludinggoodwill NUMERIC,
                        averagedilutionearnings NUMERIC,
                        generalandadministrativeexpense NUMERIC,
                        otherganda NUMERIC,
                        sellingandmarketingexpense NUMERIC,
                        amortization NUMERIC,
                        amortizationofintangiblesincomestatement NUMERIC,
                        depreciationamortizationdepletionincomestatement NUMERIC,
                        depreciationandamortizationinincomestatement NUMERIC,
                        earningsfromequityinterestnetoftax NUMERIC,
                        preferredstockdividends NUMERIC,
                        earningsfromequityinterest NUMERIC,
                        gainonsaleofppe NUMERIC,
                        impairmentofcapitalassets NUMERIC,
                        writeoff NUMERIC,
                        salariesandwages NUMERIC,
                        totalotherfinancecost NUMERIC,
                        othertaxes NUMERIC,
                        gainonsaleofbusiness NUMERIC,
                        netincomediscontinuousoperations NUMERIC,
                        provisionfordoubtfulaccounts NUMERIC,
                        depreciationincomestatement NUMERIC,
                        rentandlandingfees NUMERIC,
                        rentexpensesupplemental NUMERIC,
                        insuranceandclaims NUMERIC,
                        excisetaxes NUMERIC,
                        netincomeextraordinary NUMERIC,
                        securitiesamortization NUMERIC,
                        netincomefromtaxlosscarryforward NUMERIC,
                        depletionincomestatement NUMERIC
                    );
                """)

                # Create fundamentals_financial_data
                cur.execute(f"""
                CREATE TABLE IF NOT EXISTS {schema}.fundamentals_financial_data (
                    ticker TEXT,
                    date DATE,
                    fin_currentprice NUMERIC(12,4),
                    fin_currentratio NUMERIC(10,4),
                    fin_debttoequity NUMERIC(15,4),
                    fin_earningsgrowth NUMERIC(10,4),
                    fin_ebitda NUMERIC(20,0),
                    fin_ebitdamargins NUMERIC(10,6),
                    fin_financialcurrency TEXT,
                    fin_freecashflow NUMERIC(20,0),
                    fin_grossmargins NUMERIC(10,6),
                    fin_grossprofits NUMERIC(20,0),
                    fin_maxage NUMERIC(10,0),
                    fin_numberofanalystopinions NUMERIC(10,0),
                    fin_operatingcashflow NUMERIC(20,0),
                    fin_operatingmargins NUMERIC(10,6),
                    fin_profitmargins NUMERIC(10,6),
                    fin_quickratio NUMERIC(10,4),
                    fin_recommendationkey TEXT,
                    fin_recommendationmean NUMERIC(10,4),
                    fin_returnonassets NUMERIC(10,6),
                    fin_returnonequity NUMERIC(10,6),
                    fin_revenuegrowth NUMERIC(10,4),
                    fin_revenuepershare NUMERIC(12,4),
                    fin_targethighprice NUMERIC(12,4),
                    fin_targetlowprice NUMERIC(12,4),
                    fin_targetmeanprice NUMERIC(12,4),
                    fin_targetmedianprice NUMERIC(12,4),
                    fin_totalcash NUMERIC(20,0),
                    fin_totalcashpershare NUMERIC(12,4),
                    fin_totaldebt NUMERIC(20,0),
                    fin_totalrevenue NUMERIC(20,0)
                );
                """)

                # Create fundamentals_key_stats
                cur.execute(f"""
                CREATE TABLE IF NOT EXISTS {schema}.fundamentals_key_stats (
                    ticker TEXT,
                    date DATE,
                    keystats_52weekchange NUMERIC(10,8),
                    keystats_sandp52weekchange NUMERIC(10,8),
                    keystats_beta NUMERIC(10,4),
                    keystats_bookvalue NUMERIC(12,4),
                    keystats_category TEXT,
                    keystats_dateshortinterest TIMESTAMP WITHOUT TIME ZONE,
                    keystats_earningsquarterlygrowth NUMERIC(10,4),
                    keystats_enterprisetoebitda NUMERIC(12,4),
                    keystats_enterprisetorevenue NUMERIC(12,4),
                    keystats_enterprisevalue NUMERIC(20,0),
                    keystats_floatshares NUMERIC(20,0),
                    keystats_forwardeps NUMERIC(10,4),
                    keystats_forwardpe NUMERIC(10,4),
                    keystats_fundfamily TEXT,
                    keystats_heldpercentinsiders NUMERIC(10,6),
                    keystats_heldpercentinstitutions NUMERIC(10,6),
                    keystats_impliedsharesoutstanding NUMERIC(20,0),
                    keystats_lastdividenddate NUMERIC(20,0),
                    keystats_lastdividendvalue NUMERIC(10,4),
                    keystats_lastfiscalyearend TIMESTAMP WITHOUT TIME ZONE,
                    keystats_lastsplitdate TEXT,
                    keystats_lastsplitfactor TEXT,
                    keystats_latestshareclass TEXT,
                    keystats_leadinvestor TEXT,
                    keystats_legaltype TEXT,
                    keystats_maxage INTEGER,
                    keystats_mostrecentquarter TIMESTAMP WITHOUT TIME ZONE,
                    keystats_netincometocommon NUMERIC(20,0),
                    keystats_nextfiscalyearend TIMESTAMP WITHOUT TIME ZONE,
                    keystats_pricehint INTEGER,
                    keystats_pricetobook NUMERIC(12,4),
                    keystats_profitmargins NUMERIC(10,6),
                    keystats_sharesoutstanding NUMERIC(20,0),
                    keystats_sharespercentsharesout NUMERIC(10,6),
                    keystats_sharesshort NUMERIC(20,0),
                    keystats_sharesshortpreviousmonthdate DATE,
                    keystats_shortpercentoffloat NUMERIC(10,6),
                    keystats_shortratio NUMERIC(10,4),
                    keystats_trailingeps NUMERIC(10,4),
                    keystats_sharesshortpriormonth NUMERIC(20,0)
                );
                """)

                # Create fundamentals_price_data
                cur.execute(f"""
                CREATE TABLE IF NOT EXISTS {schema}.fundamentals_price_data (
                    ticker TEXT,
                    date DATE,
                    price_currency TEXT,
                    price_currencysymbol TEXT,
                    price_exchange TEXT,
                    price_exchangedatadelayedby NUMERIC(10,0),
                    price_exchangename TEXT,
                    price_fromcurrency TEXT,
                    price_lastmarket TEXT,
                    price_longname TEXT,
                    price_marketcap NUMERIC(20,0),
                    price_marketstate TEXT,
                    price_maxage NUMERIC(10,0),
                    price_postmarketchange NUMERIC(16,8),
                    price_postmarketchangepercent NUMERIC(16,8),
                    price_postmarketprice NUMERIC(16,4),
                    price_postmarketsource TEXT,
                    price_postmarkettime TIMESTAMP WITHOUT TIME ZONE,
                    price_premarketchange NUMERIC(16,8),
                    price_premarketchangepercent NUMERIC(16,8),
                    price_premarketprice NUMERIC(16,4),
                    price_premarketsource TEXT,
                    price_premarkettime TIMESTAMP WITHOUT TIME ZONE,
                    price_pricehint NUMERIC(10,0),
                    price_quotesourcename TEXT,
                    price_quotetype TEXT,
                    price_regularmarketchange NUMERIC(16,4),
                    price_regularmarketchangepercent NUMERIC(16,8),
                    price_regularmarketdayhigh NUMERIC(16,4),
                    price_regularmarketdaylow NUMERIC(16,4),
                    price_regularmarketopen NUMERIC(16,4),
                    price_regularmarketpreviousclose NUMERIC(16,4),
                    price_regularmarketprice NUMERIC(16,4),
                    price_regularmarketsource TEXT,
                    price_regularmarkettime TIMESTAMP WITHOUT TIME ZONE,
                    price_regularmarketvolume NUMERIC(20,0),
                    price_shortname TEXT,
                    price_symbol TEXT,
                    price_tocurrency TEXT,
                    price_underlyingsymbol TEXT
                );
                """)

                # Create fundamentals_profile_data
                cur.execute(f"""
                CREATE TABLE IF NOT EXISTS {schema}.fundamentals_profile_data (
                    ticker TEXT,
                    date DATE,
                    profile_address1 TEXT,
                    profile_address2 TEXT,
                    profile_auditrisk NUMERIC(20,0),
                    profile_boardrisk NUMERIC(20,0),
                    profile_city TEXT,
                    profile_companyofficers JSON,
                    profile_compensationasofepochdate TIMESTAMP WITHOUT TIME ZONE,
                    profile_compensationrisk NUMERIC(20,0),
                    profile_country TEXT,
                    profile_executiveteam JSON,
                    profile_fax TEXT,
                    profile_fulltimeemployees NUMERIC(20,0),
                    profile_governanceepochdate TIMESTAMP WITHOUT TIME ZONE,
                    profile_industry TEXT,
                    profile_industrydisp TEXT,
                    profile_industrykey TEXT,
                    profile_industrysymbol TEXT,
                    profile_irwebsite TEXT,
                    profile_longbusinesssummary TEXT,
                    profile_maxage NUMERIC(20,0),
                    profile_overallrisk NUMERIC(20,0),
                    profile_phone TEXT,
                    profile_sector TEXT,
                    profile_sectordisp TEXT,
                    profile_sectorkey TEXT,
                    profile_shareholderrightsrisk NUMERIC(20,0),
                    profile_state TEXT,
                    profile_website TEXT,
                    profile_zip TEXT
                );
                """)

                # Create fundamentals_summary_data
                cur.execute(f"""
                CREATE TABLE IF NOT EXISTS {schema}.fundamentals_summary_data (
                    ticker TEXT,
                    date DATE,
                    summary_algorithm TEXT,
                    summary_ask NUMERIC(18,6),
                    summary_asksize NUMERIC(30,0),
                    summary_averagedailyvolume10day NUMERIC(30,0),
                    summary_averagevolume NUMERIC(30,0),
                    summary_averagevolume10days NUMERIC(30,0),
                    summary_beta NUMERIC(12,6),
                    summary_bid NUMERIC(18,6),
                    summary_bidsize NUMERIC(30,0),
                    summary_coinmarketcaplink TEXT,
                    summary_currency TEXT,
                    summary_dayhigh NUMERIC(18,6),
                    summary_daylow NUMERIC(18,6),
                    summary_dividendrate NUMERIC(12,6),
                    summary_dividendyield NUMERIC(12,6),
                    summary_exdividenddate TIMESTAMP WITHOUT TIME ZONE,
                    summary_fiftydayaverage NUMERIC(18,6),
                    summary_fiftytwoweekhigh NUMERIC(18,6),
                    summary_fiftytwoweeklow NUMERIC(18,6),
                    summary_fiveyearavgdividendyield NUMERIC(12,6),
                    summary_forwardpe NUMERIC(18,6),
                    summary_fromcurrency TEXT,
                    summary_lastmarket TEXT,
                    summary_marketcap NUMERIC(30,0),
                    summary_maxage NUMERIC(30,0),
                    summary_open NUMERIC(18,6),
                    summary_payoutratio NUMERIC(12,6),
                    summary_previousclose NUMERIC(18,6),
                    summary_pricehint NUMERIC(30,0),
                    summary_pricetosalestrailing12months NUMERIC(18,6),
                    summary_regularmarketdayhigh NUMERIC(18,6),
                    summary_regularmarketdaylow NUMERIC(18,6),
                    summary_regularmarketopen NUMERIC(18,6),
                    summary_regularmarketpreviousclose NUMERIC(18,6),
                    summary_regularmarketvolume NUMERIC(30,0),
                    summary_tocurrency TEXT,
                    summary_tradeable BOOLEAN,
                    summary_trailingannualdividendrate NUMERIC(12,6),
                    summary_trailingannualdividendyield NUMERIC(12,6),
                    summary_trailingpe NUMERIC(18,6),
                    summary_twohundreddayaverage NUMERIC(18,6),
                    summary_volume NUMERIC(30,0)
                );
                """)


                print("âœ… All tables created successfully.")

    except Exception as e:
        print(f"âŒ Error during DB init: {e}")

if __name__ == '__main__':
    create_schema_and_tables()
